(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-template-crop-crop"],{"5a0d":function(t,e,o){var a=o("c485");"string"===typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);var n=o("4f06").default;n("26d4b5be",a,!0,{sourceMap:!1,shadowMode:!1})},c485:function(t,e,o){e=t.exports=o("2350")(!1),e.push([t.i,'\n.cropper-config[data-v-fd0deb26]{padding:%?20?% %?40?%\n}\n.cropper-content[data-v-fd0deb26]{min-height:%?750?%;width:100%\n}\n.uni-corpper[data-v-fd0deb26]{overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-box-sizing:border-box;box-sizing:border-box\n}\n.uni-corpper[data-v-fd0deb26],.uni-corpper-content[data-v-fd0deb26]{position:relative\n}\n.uni-corpper-content uni-image[data-v-fd0deb26]{display:block;width:100%;min-width:0!important;max-width:none!important;height:100%;min-height:0!important;max-height:none!important;image-orientation:0deg!important;margin:0 auto\n}\n.uni-cropper-drag-box[data-v-fd0deb26]{position:absolute;top:0;right:0;bottom:0;left:0;cursor:move;background:rgba(0,0,0,.6);z-index:1\n}\n.uni-corpper-crop-box[data-v-fd0deb26]{position:absolute;background:hsla(0,0%,100%,.3);z-index:2\n}\n.uni-corpper-crop-box .uni-cropper-view-box[data-v-fd0deb26]{position:relative;display:block;width:100%;height:100%;overflow:visible;outline:%?1?% solid #69f;outline-color:rgba(102,153,255,.75)\n}\n.uni-cropper-dashed-h[data-v-fd0deb26]{position:absolute;top:33.33333333%;left:0;width:100%;height:33.33333333%;border-top:%?1?% dashed hsla(0,0%,100%,.5);border-bottom:%?1?% dashed hsla(0,0%,100%,.5)\n}\n.uni-cropper-dashed-v[data-v-fd0deb26]{position:absolute;left:33.33333333%;top:0;width:33.33333333%;height:100%;border-left:%?1?% dashed hsla(0,0%,100%,.5);border-right:%?1?% dashed hsla(0,0%,100%,.5)\n}\n.uni-cropper-line-t[data-v-fd0deb26]{position:absolute;display:block;width:100%;background-color:#69f;top:0;left:0;height:%?1?%;opacity:.1;cursor:n-resize\n}\n.uni-cropper-line-t[data-v-fd0deb26]:before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:rgba(0,0,0,0);z-index:11\n}\n.uni-cropper-line-r[data-v-fd0deb26]{position:absolute;display:block;background-color:#69f;top:0;right:%?0?%;width:%?1?%;opacity:.1;height:100%;cursor:e-resize\n}\n.uni-cropper-line-r[data-v-fd0deb26]:before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:rgba(0,0,0,0);z-index:11\n}\n.uni-cropper-line-b[data-v-fd0deb26]{position:absolute;display:block;width:100%;background-color:#69f;bottom:0;left:0;height:%?1?%;opacity:.1;cursor:s-resize\n}\n.uni-cropper-line-b[data-v-fd0deb26]:before{content:"";position:absolute;top:50%;right:%?0?%;width:100%;-webkit-transform:translate3d(0,-50%,0);transform:translate3d(0,-50%,0);bottom:0;height:%?41?%;background:rgba(0,0,0,0);z-index:11\n}\n.uni-cropper-line-l[data-v-fd0deb26]{position:absolute;display:block;background-color:#69f;top:0;left:0;width:%?1?%;opacity:.1;height:100%;cursor:w-resize\n}\n.uni-cropper-line-l[data-v-fd0deb26]:before{content:"";position:absolute;top:0;left:50%;width:%?41?%;-webkit-transform:translate3d(-50%,0,0);transform:translate3d(-50%,0,0);bottom:0;height:100%;background:rgba(0,0,0,0);z-index:11\n}\n.uni-cropper-point[data-v-fd0deb26]{width:%?5?%;height:%?5?%;background-color:#69f;opacity:.75;position:absolute;z-index:3\n}\n.point-t[data-v-fd0deb26]{left:50%\n}\n.point-t[data-v-fd0deb26],.point-tr[data-v-fd0deb26]{top:%?-3?%;margin-left:%?-3?%;cursor:n-resize\n}\n.point-tr[data-v-fd0deb26]{left:100%\n}\n.point-r[data-v-fd0deb26]{top:50%;margin-left:%?-3?%;margin-top:%?-3?%\n}\n.point-r[data-v-fd0deb26],.point-rb[data-v-fd0deb26]{left:100%;cursor:n-resize\n}\n.point-rb[data-v-fd0deb26]{top:100%;-webkit-transform:translate3d(-50%,-50%,0);transform:translate3d(-50%,-50%,0);width:%?36?%;height:%?36?%;background-color:#69f;position:absolute;z-index:1112;opacity:1\n}\n.point-b[data-v-fd0deb26]{left:50%\n}\n.point-b[data-v-fd0deb26],.point-bl[data-v-fd0deb26]{top:100%;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize\n}\n.point-bl[data-v-fd0deb26]{left:0\n}\n.point-l[data-v-fd0deb26]{top:50%\n}\n.point-l[data-v-fd0deb26],.point-lt[data-v-fd0deb26]{left:0;margin-left:%?-3?%;margin-top:%?-3?%;cursor:n-resize\n}\n.point-lt[data-v-fd0deb26]{top:0\n}\n.uni-cropper-viewer[data-v-fd0deb26]{position:relative;width:100%;height:100%;overflow:hidden\n}\n.uni-cropper-viewer uni-image[data-v-fd0deb26]{position:absolute;z-index:2\n}',""])},e1dc:function(t,e,o){"use strict";o.r(e);var a,n,i,r,c,p,s,d,u,h,l,g=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("v-uni-view",{staticClass:"container"},[o("v-uni-view",{staticClass:"page-body uni-content-info"},[o("v-uni-view",{staticClass:"cropper-content"},[t.isShowImg?o("v-uni-view",{staticClass:"uni-corpper",style:"width:"+t.cropperInitW+"px;height:"+t.cropperInitH+"px;background:#000"},[o("v-uni-view",{staticClass:"uni-corpper-content",style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px;left:"+t.cropperL+"px;top:"+t.cropperT+"px"},[o("v-uni-image",{style:"width:"+t.cropperW+"px;height:"+t.cropperH+"px",attrs:{src:t.imageSrc}}),o("v-uni-view",{staticClass:"uni-corpper-crop-box",style:"left:"+t.cutL+"px;top:"+t.cutT+"px;right:"+t.cutR+"px;bottom:"+t.cutB+"px",on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.contentStartMove(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.contentMoveing(e)},touchend:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.contentTouchEnd(e)}}},[o("v-uni-view",{staticClass:"uni-cropper-view-box"},[o("v-uni-view",{staticClass:"uni-cropper-dashed-h"}),o("v-uni-view",{staticClass:"uni-cropper-dashed-v"}),o("v-uni-view",{staticClass:"uni-cropper-line-t",attrs:{"data-drag":"top"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-line-r",attrs:{"data-drag":"right"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-line-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-line-l",attrs:{"data-drag":"left"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-point point-t",attrs:{"data-drag":"top"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-point point-tr",attrs:{"data-drag":"topTight"}}),o("v-uni-view",{staticClass:"uni-cropper-point point-r",attrs:{"data-drag":"right"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-point point-rb",attrs:{"data-drag":"rightBottom"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-point point-b",attrs:{"data-drag":"bottom"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)},touchend:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragEnd(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-point point-bl",attrs:{"data-drag":"bottomLeft"}}),o("v-uni-view",{staticClass:"uni-cropper-point point-l",attrs:{"data-drag":"left"},on:{touchstart:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragStart(e)},touchmove:function(e){e.stopPropagation(),e=t.$handleEvent(e),t.dragMove(e)}}}),o("v-uni-view",{staticClass:"uni-cropper-point point-lt",attrs:{"data-drag":"leftTop"}})],1)],1)],1)],1):t._e()],1),o("v-uni-view",{staticClass:"cropper-config"},[o("v-uni-button",{staticStyle:{"margin-top":"30upx"},attrs:{type:"primary reverse"},on:{click:function(e){e=t.$handleEvent(e),t.getImage(e)}}},[t._v(" 选择图片 ")]),o("v-uni-button",{staticStyle:{"margin-top":"30upx"},attrs:{type:"warn"},on:{click:function(e){e=t.$handleEvent(e),t.getImageInfo(e)}}},[t._v(" 点击生成图片 ")])],1),o("v-uni-canvas",{style:"position:absolute;border: 1px solid red; width:"+t.imageW+"px;height:"+t.imageH+"px;top:-9999px;left:-9999px;",attrs:{"canvas-id":"myCanvas"}})],1),o("page-foot",{attrs:{name:t.name}})],1)},v=[],f=uni.getSystemInfoSync(),b=f.screenWidth,m=(f.pixelRatio,1),w=100,x=f.screenWidth,k={data:function(){return{name:"杨大宝",imageSrc:"https://img-cdn-qiniu.dcloud.net.cn/demo_crop.jpg",isShowImg:!1,cropperInitW:b,cropperInitH:b,cropperW:b,cropperH:b,cropperL:0,cropperT:0,transL:0,transT:0,scaleP:0,imageW:0,imageH:0,cutL:0,cutT:0,cutB:b,cutR:"100%",qualityWidth:x,innerAspectRadio:m}},onLoad:function(t){},mounted:function(){this.loadImage()},methods:{setData:function(t){var e=this;Object.keys(t).forEach(function(o){e.$set(e.$data,o,t[o])})},getImage:function(){var t=this;uni.chooseImage({success:function(e){t.setData({imageSrc:e.tempFilePaths[0]}),t.loadImage()}})},loadImage:function(){var t=this;uni.showLoading({title:"图片加载中..."}),uni.getImageInfo({src:t.imageSrc,success:function(e){u=e.width/e.height,u>=1?(h=b,l=b/u):(h=b*u,l=b);var o=h>l?h:l;if(w=o>w?w:o,u>=1){var a=Math.ceil((b/u-(b/u-w))/2),n=a,i=Math.ceil((b-b+w)/2),r=i;t.setData({cropperW:b,cropperH:b/u,cropperL:Math.ceil((b-b)/2),cropperT:Math.ceil((b-b/u)/2),cutL:i,cutT:a,cutR:r,cutB:n,imageW:h,imageH:l,scaleP:h/b,qualityWidth:x,innerAspectRadio:u})}else{var c=Math.ceil((b*u-b*u)/2),p=c,s=Math.ceil((b-w)/2),d=s;t.setData({cropperW:b*u,cropperH:b,cropperL:Math.ceil((b-b*u)/2),cropperT:Math.ceil((b-b)/2),cutL:c,cutT:s,cutR:p,cutB:d,imageW:h,imageH:l,scaleP:h/b,qualityWidth:x,innerAspectRadio:u})}t.setData({isShowImg:!0}),uni.hideLoading()}})},contentStartMove:function(t){a=t.touches[0].pageX,n=t.touches[0].pageY},contentMoveing:function(t){var e=(a-t.touches[0].pageX)*m,o=(n-t.touches[0].pageY)*m;e>0?this.cutL-e<0&&(e=this.cutL):this.cutR+e<0&&(e=-this.cutR),o>0?this.cutT-o<0&&(o=this.cutT):this.cutB+o<0&&(o=-this.cutB),this.setData({cutL:this.cutL-e,cutT:this.cutT-o,cutR:this.cutR+e,cutB:this.cutB+o}),a=t.touches[0].pageX,n=t.touches[0].pageY},contentTouchEnd:function(){},getImageInfo:function(){var t=this;uni.showLoading({title:"图片生成中..."});var e=uni.createCanvasContext("myCanvas");e.drawImage(t.imageSrc,0,0,h,l),e.draw(!0,function(){var e=(t.cropperW-t.cutL-t.cutR)/t.cropperW*h,o=(t.cropperH-t.cutT-t.cutB)/t.cropperH*l,a=t.cutL/t.cropperW*h,n=t.cutT/t.cropperH*l;uni.canvasToTempFilePath({x:a,y:n,width:e,height:o,destWidth:e,destHeight:o,quality:.5,canvasId:"myCanvas",success:function(t){uni.hideLoading(),uni.previewImage({current:"",urls:[t.tempFilePath]})}})})},dragStart:function(t){i=t.touches[0].pageX,r=t.touches[0].pageY,c=this.cutL,s=this.cutR,d=this.cutB,p=this.cutT},dragMove:function(t){var e=t.target.dataset.drag;switch(e){case"right":var o=(i-t.touches[0].pageX)*m;s+o<0&&(o=-s),this.setData({cutR:s+o});break;case"left":o=(i-t.touches[0].pageX)*m;c-o<0&&(o=c),c-o>this.cropperW-this.cutR&&(o=c-(this.cropperW-this.cutR)),this.setData({cutL:c-o});break;case"top":o=(r-t.touches[0].pageY)*m;p-o<0&&(o=p),p-o>this.cropperH-this.cutB&&(o=p-(this.cropperH-this.cutB)),this.setData({cutT:p-o});break;case"bottom":o=(r-t.touches[0].pageY)*m;d+o<0&&(o=-d),this.setData({cutB:d+o});break;case"rightBottom":var a=(i-t.touches[0].pageX)*m,n=(r-t.touches[0].pageY)*m;d+n<0&&(n=-d),s+a<0&&(a=-s);var u=d+n,h=s+a;this.setData({cutB:u,cutR:h});break;default:break}}}},y=k,E=(o("ee31"),o("2877")),P=Object(E["a"])(y,g,v,!1,null,"fd0deb26",null);P.options.__file="crop.vue";e["default"]=P.exports},ee31:function(t,e,o){"use strict";var a=o("5a0d"),n=o.n(a);n.a}}]);